(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))x(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const e of i.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&x(e)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function x(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();async function B(){console.log("Starting boid simulation (v1.0.4)...");const m=window.RAPIER;if(!m)throw new Error("RAPIER not found on window. Ensure CDN script is loaded.");await m.init(),console.log("RAPIER module ready");const a=document.createElement("canvas"),t=a.getContext("2d");document.getElementById("app").appendChild(a);function x(){a.width=window.innerWidth,a.height=window.innerHeight}window.addEventListener("resize",x),x();const o={x:0,y:0},i=new m.World(o),e=2e3,p=500,v=p/10,R=m.RigidBodyDesc.dynamic().setTranslation(0,0).setLinearDamping(.5).setAngularDamping(2),l=i.createRigidBody(R),M=new Float32Array([0,15,-10,-10,10,-10]),S=m.ColliderDesc.convexHull(M);i.createCollider(S,l);const g={};window.addEventListener("keydown",n=>g[n.key.toLowerCase()]=!0),window.addEventListener("keyup",n=>g[n.key.toLowerCase()]=!1);let d=0,f=0;const c=document.createElement("div");c.style.position="absolute",c.style.top="20px",c.style.left="20px",c.style.padding="20px",c.style.background="rgba(0, 0, 0, 0.7)",c.style.borderRadius="12px",c.style.backdropFilter="blur(10px)",c.style.border="1px solid rgba(255, 255, 255, 0.1)",c.style.pointerEvents="none",c.style.fontSize="14px",c.innerHTML=`
    <div style="margin-bottom: 10px; font-weight: bold; color: #4facfe;">BOID SYSTEMS</div>
    <div id="left-stat">Left Thruster: 0</div>
    <div id="right-stat">Right Thruster: 0</div>
    <div id="vel-stat">Velocity: 0</div>
    <div id="rot-stat">Rotation Power: 0</div>
    <div style="margin-top: 10px; opacity: 0.6; font-size: 12px;">Q/A: Left | W/S: Right</div>
  `,document.body.appendChild(c);const P=document.getElementById("left-stat"),L=document.getElementById("right-stat"),I=document.getElementById("vel-stat"),k=document.getElementById("rot-stat");function A(){g.q&&(d=Math.min(d+v,p)),g.a&&(d=Math.max(d-v,0)),g.w&&(f=Math.min(f+v,p)),g.s&&(f=Math.max(f-v,0));const n=l.rotation(),u=-Math.sin(n),y=Math.cos(n),r={x:-10,y:-10},b={x:10,y:-10},s=(h,T)=>({x:h.x*Math.cos(T)-h.y*Math.sin(T),y:h.x*Math.sin(T)+h.y*Math.cos(T)}),w=l.translation();if(d>0){const h=s(r,n);l.applyImpulseAtPoint({x:u*d*.1,y:y*d*.1},{x:w.x+h.x,y:w.y+h.y},!0)}if(f>0){const h=s(b,n);l.applyImpulseAtPoint({x:u*f*.1,y:y*f*.1},{x:w.x+h.x,y:w.y+h.y},!0)}}function W(){let{x:n,y:u}=l.translation();const y=e/2;let r=!1;n>y?(n-=e,r=!0):n<-y&&(n+=e,r=!0),u>y?(u-=e,r=!0):u<-y&&(u+=e,r=!0),r&&l.setTranslation({x:n,y:u},!0)}function D(){t.clearRect(0,0,a.width,a.height);const n=l.translation().x,u=l.translation().y;t.save(),t.translate(a.width/2,a.height/2),t.scale(1,-1),t.save(),t.translate(-n,-u),t.strokeStyle="rgba(255, 255, 255, 0.05)",t.lineWidth=1;for(let s=-e/2;s<=e/2;s+=100)t.beginPath(),t.moveTo(s,-e/2),t.lineTo(s,e/2),t.stroke(),t.beginPath(),t.moveTo(-e/2,s),t.lineTo(e/2,s),t.stroke();t.strokeStyle="#4facfe",t.lineWidth=4,t.strokeRect(-e/2,-e/2,e,e),t.restore(),t.save(),t.rotate(l.rotation()),t.beginPath(),t.moveTo(0,15),t.lineTo(-10,-10),t.lineTo(10,-10),t.closePath(),t.fillStyle="#fff",t.fill(),t.strokeStyle="#4facfe",t.lineWidth=2,t.stroke();const y=30;if(d>0){const s=d/p*y;t.beginPath(),t.moveTo(-7,-10),t.lineTo(-7,-10-s),t.strokeStyle="#ff4b2b",t.lineWidth=4,t.stroke()}if(f>0){const s=f/p*y;t.beginPath(),t.moveTo(7,-10),t.lineTo(7,-10-s),t.strokeStyle="#ff4b2b",t.lineWidth=4,t.stroke()}t.restore(),t.restore(),P.innerText=`Left Thruster: ${Math.round(d/p*100)}%`,L.innerText=`Right Thruster: ${Math.round(f/p*100)}%`;const r=l.linvel(),b=Math.sqrt(r.x*r.x+r.y*r.y);I.innerText=`Velocity: ${Math.round(b)} | Angle: ${Math.round(Math.atan2(r.y,r.x)*180/Math.PI)}Â°`,k.innerText=`Rotation Power: ${l.angvel().toFixed(2)}`}function E(){A(),i.step(),W(),D(),requestAnimationFrame(E)}E()}B().catch(console.error);
